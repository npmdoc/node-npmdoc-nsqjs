<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/dudleycarr/nsqjs"

    >nsqjs (v0.8.4)</a>
</h1>
<h4>NodeJS client for NSQ</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs">module nsqjs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.backofftimer">
            function <span class="apidocSignatureSpan">nsqjs.</span>backofftimer
            <span class="apidocSignatureSpan">(minInterval, maxInterval, ratio, shortLength, longLength)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer">
            function <span class="apidocSignatureSpan">nsqjs.</span>framebuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message">
            function <span class="apidocSignatureSpan">nsqjs.</span>message
            <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist">
            function <span class="apidocSignatureSpan">nsqjs.</span>roundrobinlist
            <span class="apidocSignatureSpan">(lst)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer">
            function <span class="apidocSignatureSpan">nsqjs.</span>writer
            <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>backofftimer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>config</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>framebuffer.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>message.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>readerrdy</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>roundrobinlist.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>wire</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.</span>writer.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.backofftimer">module nsqjs.backofftimer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.backofftimer.backofftimer">
            function <span class="apidocSignatureSpan">nsqjs.</span>backofftimer
            <span class="apidocSignatureSpan">(minInterval, maxInterval, ratio, shortLength, longLength)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.backofftimer.prototype">module nsqjs.backofftimer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.backofftimer.prototype.failure">
            function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>failure
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.backofftimer.prototype.getInterval">
            function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>getInterval
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.backofftimer.prototype.success">
            function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>success
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.config">module nsqjs.config</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.config.ConnectionConfig">
            function <span class="apidocSignatureSpan">nsqjs.config.</span>ConnectionConfig
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.config.ReaderConfig">
            function <span class="apidocSignatureSpan">nsqjs.config.</span>ReaderConfig
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.framebuffer">module nsqjs.framebuffer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.framebuffer">
            function <span class="apidocSignatureSpan">nsqjs.</span>framebuffer
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.framebuffer.prototype">module nsqjs.framebuffer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.prototype.consume">
            function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>consume
            <span class="apidocSignatureSpan">(raw)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.prototype.frameSize">
            function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>frameSize
            <span class="apidocSignatureSpan">(offset)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.prototype.nextFrame">
            function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>nextFrame
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.prototype.nextOffset">
            function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>nextOffset
            <span class="apidocSignatureSpan">(offset)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.framebuffer.prototype.pluckFrame">
            function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>pluckFrame
            <span class="apidocSignatureSpan">(offset)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.message">module nsqjs.message</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">nsqjs.message.</span>usingDomains</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.message">
            function <span class="apidocSignatureSpan">nsqjs.</span>message
            <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.EventEmitter">
            function <span class="apidocSignatureSpan">nsqjs.message.</span>EventEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.init">
            function <span class="apidocSignatureSpan">nsqjs.message.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.listenerCount">
            function <span class="apidocSignatureSpan">nsqjs.message.</span>listenerCount
            <span class="apidocSignatureSpan">(emitter, type)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.message.</span>FINISH</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.message.</span>REQUEUE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.message.</span>TOUCH</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.message.</span>defaultMaxListeners</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.message.</span>__super__</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.message.</span>BACKOFF</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.message.</span>RESPOND</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.message.prototype">module nsqjs.message.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.constructor">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>constructor
            <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.finish">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>finish
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.json">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>json
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.requeue">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>requeue
            <span class="apidocSignatureSpan">(delay, backoff)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.respond">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>respond
            <span class="apidocSignatureSpan">(responseType, wireData)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.timeUntilTimeout">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>timeUntilTimeout
            <span class="apidocSignatureSpan">(hard)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.message.prototype.touch">
            function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>touch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.readerrdy">module nsqjs.readerrdy</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.readerrdy.ConnectionRdy">
            function <span class="apidocSignatureSpan">nsqjs.readerrdy.</span>ConnectionRdy
            <span class="apidocSignatureSpan">(conn1)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.readerrdy.ReaderRdy">
            function <span class="apidocSignatureSpan">nsqjs.readerrdy.</span>ReaderRdy
            <span class="apidocSignatureSpan">(maxInFlight, maxBackoffDuration, readerId1, lowRdyTimeout)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.roundrobinlist">module nsqjs.roundrobinlist</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist.roundrobinlist">
            function <span class="apidocSignatureSpan">nsqjs.</span>roundrobinlist
            <span class="apidocSignatureSpan">(lst)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.roundrobinlist.prototype">module nsqjs.roundrobinlist.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist.prototype.add">
            function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>add
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist.prototype.length">
            function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>length
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist.prototype.next">
            function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>next
            <span class="apidocSignatureSpan">(count)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.roundrobinlist.prototype.remove">
            function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>remove
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.wire">module nsqjs.wire</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.auth">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>auth
            <span class="apidocSignatureSpan">(token)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.finish">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>finish
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.identify">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>identify
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.mpub">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>mpub
            <span class="apidocSignatureSpan">(topic, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.nop">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>nop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.pub">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>pub
            <span class="apidocSignatureSpan">(topic, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.ready">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>ready
            <span class="apidocSignatureSpan">(count)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.requeue">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>requeue
            <span class="apidocSignatureSpan">(id, timeMs)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.subscribe">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>subscribe
            <span class="apidocSignatureSpan">(topic, channel)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.touch">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>touch
            <span class="apidocSignatureSpan">(id)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.wire.unpackMessage">
            function <span class="apidocSignatureSpan">nsqjs.wire.</span>unpackMessage
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.wire.</span>FRAME_TYPE_ERROR</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.wire.</span>FRAME_TYPE_MESSAGE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.wire.</span>FRAME_TYPE_RESPONSE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.wire.</span>MAGIC_V2</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.writer">module nsqjs.writer</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">nsqjs.writer.</span>usingDomains</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.writer">
            function <span class="apidocSignatureSpan">nsqjs.</span>writer
            <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.EventEmitter">
            function <span class="apidocSignatureSpan">nsqjs.writer.</span>EventEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.init">
            function <span class="apidocSignatureSpan">nsqjs.writer.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.listenerCount">
            function <span class="apidocSignatureSpan">nsqjs.writer.</span>listenerCount
            <span class="apidocSignatureSpan">(emitter, type)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">nsqjs.writer.</span>defaultMaxListeners</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">nsqjs.writer.</span>__super__</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.writer.</span>CLOSED</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.writer.</span>ERROR</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">nsqjs.writer.</span>READY</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.nsqjs.writer.prototype">module nsqjs.writer.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.prototype.close">
            function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.prototype.connect">
            function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>connect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.prototype.constructor">
            function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>constructor
            <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.nsqjs.writer.prototype.publish">
            function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>publish
            <span class="apidocSignatureSpan">(topic, msgs, callback)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs" id="apidoc.module.nsqjs">module nsqjs</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.backofftimer" id="apidoc.element.nsqjs.backofftimer">
        function <span class="apidocSignatureSpan">nsqjs.</span>backofftimer
        <span class="apidocSignatureSpan">(minInterval, maxInterval, ratio, shortLength, longLength)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BackoffTimer(minInterval, maxInterval, ratio, shortLength, longLength) {
  var intervalDelta;
  if (ratio == null) {
    ratio = .25;
  }
  if (shortLength == null) {
    shortLength = 10;
  }
  if (longLength == null) {
    longLength = 250;
  }
  this.minInterval = decimal(minInterval);
  this.maxInterval = decimal(maxInterval);
  ratio = decimal(ratio);
  intervalDelta = decimal(this.maxInterval - this.minInterval);
  this.maxShortTimer = intervalDelta.times(ratio);
  this.maxLongTimer = intervalDelta.times(decimal(1).minus(ratio));
  this.shortUnit = this.maxShortTimer.dividedBy(shortLength);
  this.longUnit = this.maxLongTimer.dividedBy(longLength);
  this.shortInterval = decimal(0);
  this.longInterval = decimal(0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer" id="apidoc.element.nsqjs.framebuffer">
        function <span class="apidocSignatureSpan">nsqjs.</span>framebuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function FrameBuffer() {}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message" id="apidoc.element.nsqjs.message">
        function <span class="apidocSignatureSpan">nsqjs.</span>message
        <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Message(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout) {
  var trackTimeout;
  this.id = id;
  this.timestamp = timestamp;
  this.attempts = attempts;
  this.body = body;
  this.requeueDelay = requeueDelay;
  this.msgTimeout = msgTimeout;
  this.maxMsgTimeout = maxMsgTimeout;
  this.hasResponded = false;
  this.receivedOn = Date.now();
  this.lastTouched = this.receivedOn;
  this.touchCount = 0;
  this.trackTimeoutId = null;
  this.timedOut = false;
  (trackTimeout = (function(_this) {
    return function() {
      var hard, soft;
      if (_this.hasResponded) {
        return;
      }
      soft = _this.timeUntilTimeout();
      hard = _this.timeUntilTimeout(true);
      _this.timedOut = !soft || !hard;
      if (!_this.timedOut) {
        clearTimeout(_this.trackTimeoutId);
        return _this.trackTimeoutId = setTimeout(trackTimeout, Math.min(soft, hard));
      }
    };
  })(this))();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist" id="apidoc.element.nsqjs.roundrobinlist">
        function <span class="apidocSignatureSpan">nsqjs.</span>roundrobinlist
        <span class="apidocSignatureSpan">(lst)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function RoundRobinList(lst) {
  this.lst = lst.slice(0);
  this.index = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer" id="apidoc.element.nsqjs.writer">
        function <span class="apidocSignatureSpan">nsqjs.</span>writer
        <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Writer(nsqdHost, nsqdPort, options) {
  this.nsqdHost = nsqdHost;
  this.nsqdPort = nsqdPort;
  Writer.__super__.constructor.apply(this, arguments);
  this.setMaxListeners(10000);
  this.debug = Debug(&#x22;nsqjs:writer:&#x22; + this.nsqdHost + &#x22;/&#x22; + this.nsqdPort);
  this.config = new ConnectionConfig(options);
  this.config.validate();
  this.ready = false;
  this.debug(&#x27;Configuration&#x27;);
  this.debug(this.config);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.backofftimer" id="apidoc.module.nsqjs.backofftimer">module nsqjs.backofftimer</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.backofftimer.backofftimer" id="apidoc.element.nsqjs.backofftimer.backofftimer">
        function <span class="apidocSignatureSpan">nsqjs.</span>backofftimer
        <span class="apidocSignatureSpan">(minInterval, maxInterval, ratio, shortLength, longLength)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function BackoffTimer(minInterval, maxInterval, ratio, shortLength, longLength) {
  var intervalDelta;
  if (ratio == null) {
    ratio = .25;
  }
  if (shortLength == null) {
    shortLength = 10;
  }
  if (longLength == null) {
    longLength = 250;
  }
  this.minInterval = decimal(minInterval);
  this.maxInterval = decimal(maxInterval);
  ratio = decimal(ratio);
  intervalDelta = decimal(this.maxInterval - this.minInterval);
  this.maxShortTimer = intervalDelta.times(ratio);
  this.maxLongTimer = intervalDelta.times(decimal(1).minus(ratio));
  this.shortUnit = this.maxShortTimer.dividedBy(shortLength);
  this.longUnit = this.maxLongTimer.dividedBy(longLength);
  this.shortInterval = decimal(0);
  this.longInterval = decimal(0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.backofftimer.prototype" id="apidoc.module.nsqjs.backofftimer.prototype">module nsqjs.backofftimer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.backofftimer.prototype.failure" id="apidoc.element.nsqjs.backofftimer.prototype.failure">
        function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>failure
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">failure = function () {
  this.shortInterval = this.shortInterval.plus(this.shortUnit);
  this.longInterval = this.longInterval.plus(this.longUnit);
  this.shortInterval = min(this.shortInterval, this.maxShortTimer);
  return this.longInterval = min(this.longInterval, this.maxLongTimer);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  pause: function() {
    return this.goto(&#x27;PAUSE&#x27;);
  },
  unpause: function() {}
},
BACKOFF: {
  Enter: function() {
    this.backoffTimer.<span class="apidocCodeKeywordSpan">failure</span>();
    return this.backoff();
  },
  backoff: function() {
    this.backoffTimer.failure();
    return this.backoff();
  },
  success: function() {},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.backofftimer.prototype.getInterval" id="apidoc.element.nsqjs.backofftimer.prototype.getInterval">
        function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>getInterval
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInterval = function () {
  return this.minInterval.plus(this.shortInterval.plus(this.longInterval));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  onTimeout = (function(_this) {
    return function() {
      _this.log(&#x27;Backoff done&#x27;);
      return _this.raise(&#x27;try&#x27;);
    };
  })(this);
  delay = new Number(this.backoffTimer.<span class="apidocCodeKeywordSpan">getInterval</span>().valueOf()) * 1000;
  this.backoffId = setTimeout(onTimeout, delay);
  return this.log(&#x22;Backoff for &#x22; + delay);
};

ReaderRdy.prototype.inFlight = function() {
  var add;
  add = function(previous, conn) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.backofftimer.prototype.success" id="apidoc.element.nsqjs.backofftimer.prototype.success">
        function <span class="apidocSignatureSpan">nsqjs.backofftimer.prototype.</span>success
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">success = function () {
  this.shortInterval = this.shortInterval.minus(this.shortUnit);
  this.longInterval = this.longInterval.minus(this.longUnit);
  this.shortInterval = max(this.shortInterval, decimal(0));
  return this.longInterval = max(this.longInterval, decimal(0));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Enter: function() {
  return this[&#x22;try&#x22;]();
},
backoff: function() {
  return this.goto(&#x27;BACKOFF&#x27;);
},
success: function(connectionRdy) {
  this.backoffTimer.<span class="apidocCodeKeywordSpan">success</span>();
  this.onMessageSuccess(connectionRdy);
  return this.goto(&#x27;MAX&#x27;);
},
&#x22;try&#x22;: function() {},
pause: function() {
  return this.goto(&#x27;PAUSE&#x27;);
},
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.config" id="apidoc.module.nsqjs.config">module nsqjs.config</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.config.ConnectionConfig" id="apidoc.element.nsqjs.config.ConnectionConfig">
        function <span class="apidocSignatureSpan">nsqjs.config.</span>ConnectionConfig
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConnectionConfig(options) {
  if (options == null) {
    options = {};
  }
  options = _.chain(options).pick(_.keys(this.constructor.DEFAULTS)).defaults(this.constructor.DEFAULTS).value();
  _.extend(this, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.config.ReaderConfig" id="apidoc.element.nsqjs.config.ReaderConfig">
        function <span class="apidocSignatureSpan">nsqjs.config.</span>ReaderConfig
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReaderConfig() {
  return ReaderConfig.__super__.constructor.apply(this, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.framebuffer" id="apidoc.module.nsqjs.framebuffer">module nsqjs.framebuffer</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.framebuffer" id="apidoc.element.nsqjs.framebuffer.framebuffer">
        function <span class="apidocSignatureSpan">nsqjs.</span>framebuffer
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function FrameBuffer() {}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.framebuffer.prototype" id="apidoc.module.nsqjs.framebuffer.prototype">module nsqjs.framebuffer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.prototype.consume" id="apidoc.element.nsqjs.framebuffer.prototype.consume">
        function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>consume
        <span class="apidocSignatureSpan">(raw)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">consume = function (raw) {
  return this.buffer = Buffer.concat(_.compact([this.buffer, raw]));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    })(this));
  }
};

NSQDConnection.prototype.receiveData = function(data) {
  var frame, frameId, payload, results;
  this.lastReceivedTimestamp = Date.now();
  this.frameBuffer.<span class="apidocCodeKeywordSpan">consume</span>(data);
  results = [];
  while (frame = this.frameBuffer.nextFrame()) {
    frameId = frame[0], payload = frame[1];
    switch (frameId) {
      case wire.FRAME_TYPE_RESPONSE:
        results.push(this.statemachine.raise(&#x27;response&#x27;, payload));
        break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.prototype.frameSize" id="apidoc.element.nsqjs.framebuffer.prototype.frameSize">
        function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>frameSize
        <span class="apidocSignatureSpan">(offset)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">frameSize = function (offset) {
  if (!(this.buffer &#x26;&#x26; this.buffer.length &#x3e; 4)) {
    return;
  }
  if (offset + 4 &#x3c;= this.buffer.length) {
    return 4 + this.buffer.readInt32BE(offset);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

FrameBuffer.prototype.nextFrame = function() {
  var frame, nextOffset;
  if (!this.buffer) {
    return;
  }
  if (!(this.<span class="apidocCodeKeywordSpan">frameSize</span>(0) &#x26;&#x26; this.frameSize(0) &#x3c;= this.buffer.length)) {
    return;
  }
  frame = this.pluckFrame();
  nextOffset = this.nextOffset();
  this.buffer = this.buffer.slice(nextOffset);
  if (!this.buffer.length) {
    delete this.buffer;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.prototype.nextFrame" id="apidoc.element.nsqjs.framebuffer.prototype.nextFrame">
        function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>nextFrame
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nextFrame = function () {
  var frame, nextOffset;
  if (!this.buffer) {
    return;
  }
  if (!(this.frameSize(0) &#x26;&#x26; this.frameSize(0) &#x3c;= this.buffer.length)) {
    return;
  }
  frame = this.pluckFrame();
  nextOffset = this.nextOffset();
  this.buffer = this.buffer.slice(nextOffset);
  if (!this.buffer.length) {
    delete this.buffer;
  }
  return frame;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

NSQDConnection.prototype.receiveData = function(data) {
  var frame, frameId, payload, results;
  this.lastReceivedTimestamp = Date.now();
  this.frameBuffer.consume(data);
  results = [];
  while (frame = this.frameBuffer.<span class="apidocCodeKeywordSpan">nextFrame</span>()) {
    frameId = frame[0], payload = frame[1];
    switch (frameId) {
      case wire.FRAME_TYPE_RESPONSE:
        results.push(this.statemachine.raise(&#x27;response&#x27;, payload));
        break;
      case wire.FRAME_TYPE_ERROR:
        results.push(this.statemachine.goto(&#x27;ERROR&#x27;, new Error(payload.toString())));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.prototype.nextOffset" id="apidoc.element.nsqjs.framebuffer.prototype.nextOffset">
        function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>nextOffset
        <span class="apidocSignatureSpan">(offset)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nextOffset = function (offset) {
  var size;
  if (offset == null) {
    offset = 0;
  }
  size = this.frameSize(offset);
  if (size) {
    return offset + size;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (!this.buffer) {
    return;
  }
  if (!(this.frameSize(0) &#x26;&#x26; this.frameSize(0) &#x3c;= this.buffer.length)) {
    return;
  }
  frame = this.pluckFrame();
  nextOffset = this.<span class="apidocCodeKeywordSpan">nextOffset</span>();
  this.buffer = this.buffer.slice(nextOffset);
  if (!this.buffer.length) {
    delete this.buffer;
  }
  return frame;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.framebuffer.prototype.pluckFrame" id="apidoc.element.nsqjs.framebuffer.prototype.pluckFrame">
        function <span class="apidocSignatureSpan">nsqjs.framebuffer.prototype.</span>pluckFrame
        <span class="apidocSignatureSpan">(offset)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pluckFrame = function (offset) {
  var frame, frameId;
  if (offset == null) {
    offset = 0;
  }
  frame = this.buffer.slice(offset, offset + this.frameSize(offset));
  frameId = frame.readInt32BE(4);
  return [frameId, frame.slice(8)];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var frame, nextOffset;
  if (!this.buffer) {
    return;
  }
  if (!(this.frameSize(0) &#x26;&#x26; this.frameSize(0) &#x3c;= this.buffer.length)) {
    return;
  }
  frame = this.<span class="apidocCodeKeywordSpan">pluckFrame</span>();
  nextOffset = this.nextOffset();
  this.buffer = this.buffer.slice(nextOffset);
  if (!this.buffer.length) {
    delete this.buffer;
  }
  return frame;
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.message" id="apidoc.module.nsqjs.message">module nsqjs.message</a></h1>




    <h2>
        <a href="#apidoc.element.nsqjs.message.message" id="apidoc.element.nsqjs.message.message">
        function <span class="apidocSignatureSpan">nsqjs.</span>message
        <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Message(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout) {
  var trackTimeout;
  this.id = id;
  this.timestamp = timestamp;
  this.attempts = attempts;
  this.body = body;
  this.requeueDelay = requeueDelay;
  this.msgTimeout = msgTimeout;
  this.maxMsgTimeout = maxMsgTimeout;
  this.hasResponded = false;
  this.receivedOn = Date.now();
  this.lastTouched = this.receivedOn;
  this.touchCount = 0;
  this.trackTimeoutId = null;
  this.timedOut = false;
  (trackTimeout = (function(_this) {
    return function() {
      var hard, soft;
      if (_this.hasResponded) {
        return;
      }
      soft = _this.timeUntilTimeout();
      hard = _this.timeUntilTimeout(true);
      _this.timedOut = !soft || !hard;
      if (!_this.timedOut) {
        clearTimeout(_this.trackTimeoutId);
        return _this.trackTimeoutId = setTimeout(trackTimeout, Math.min(soft, hard));
      }
    };
  })(this))();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.EventEmitter" id="apidoc.element.nsqjs.message.EventEmitter">
        function <span class="apidocSignatureSpan">nsqjs.message.</span>EventEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.init" id="apidoc.element.nsqjs.message.init">
        function <span class="apidocSignatureSpan">nsqjs.message.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  this.domain = null;
  if (EventEmitter.usingDomains) {
    // if there is an active domain, then attach to it.
    domain = domain || require(&#x27;domain&#x27;);
    if (domain.active &#x26;&#x26; !(this instanceof domain.Domain)) {
      this.domain = domain.active;
    }
  }

  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {
    this._events = new EventHandlers();
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.listenerCount" id="apidoc.element.nsqjs.message.listenerCount">
        function <span class="apidocSignatureSpan">nsqjs.message.</span>listenerCount
        <span class="apidocSignatureSpan">(emitter, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenerCount = function (emitter, type) {
  if (typeof emitter.listenerCount === &#x27;function&#x27;) {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.message.prototype" id="apidoc.module.nsqjs.message.prototype">module nsqjs.message.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.constructor" id="apidoc.element.nsqjs.message.prototype.constructor">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>constructor
        <span class="apidocSignatureSpan">(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Message(id, timestamp, attempts, body, requeueDelay, msgTimeout, maxMsgTimeout) {
  var trackTimeout;
  this.id = id;
  this.timestamp = timestamp;
  this.attempts = attempts;
  this.body = body;
  this.requeueDelay = requeueDelay;
  this.msgTimeout = msgTimeout;
  this.maxMsgTimeout = maxMsgTimeout;
  this.hasResponded = false;
  this.receivedOn = Date.now();
  this.lastTouched = this.receivedOn;
  this.touchCount = 0;
  this.trackTimeoutId = null;
  this.timedOut = false;
  (trackTimeout = (function(_this) {
    return function() {
      var hard, soft;
      if (_this.hasResponded) {
        return;
      }
      soft = _this.timeUntilTimeout();
      hard = _this.timeUntilTimeout(true);
      _this.timedOut = !soft || !hard;
      if (!_this.timedOut) {
        clearTimeout(_this.trackTimeoutId);
        return _this.trackTimeoutId = setTimeout(trackTimeout, Math.min(soft, hard));
      }
    };
  })(this))();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.finish" id="apidoc.element.nsqjs.message.prototype.finish">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>finish
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">finish = function () {
  return this.respond(Message.FINISH, wire.finish(this.id));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  lookupdHTTPAddresses: &#x27;127.0.0.1:4161&#x27;
});

reader.connect();

reader.on(&#x27;message&#x27;, function (msg) {
  console.log(&#x27;Received message [%s]: %s&#x27;, msg.id, msg.body.toString());
  msg.<span class="apidocCodeKeywordSpan">finish</span>();
});
```

#### CoffeeScript
```coffee-script
nsq = require &#x27;nsqjs&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.json" id="apidoc.element.nsqjs.message.prototype.json">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>json
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function () {
  var err;
  if (this.parsed == null) {
    try {
      this.parsed = JSON.parse(this.body);
    } catch (error) {
      err = error;
      throw new Error(&#x22;Invalid JSON in Message&#x22;);
    }
  }
  return this.parsed;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      writer.publish topic, &#x27;pause test&#x27;

    it &#x27;should not receive any new messages when paused&#x27;, (done) -&#x3e;
      writer.publish topic, messageShouldArrive: true

      reader.on &#x27;message&#x27;, (msg) -&#x3e;
# check the message
msg.<span class="apidocCodeKeywordSpan">json</span>().messageShouldArrive.should.be.true()
msg.finish()

if reader.isPaused() then return done()

reader.pause()

process.nextTick -&#x3e;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.requeue" id="apidoc.element.nsqjs.message.prototype.requeue">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>requeue
        <span class="apidocSignatureSpan">(delay, backoff)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">requeue = function (delay, backoff) {
  if (delay == null) {
    delay = this.requeueDelay;
  }
  if (backoff == null) {
    backoff = true;
  }
  this.respond(Message.REQUEUE, wire.requeue(this.id, delay));
  if (backoff) {
    return this.emit(Message.BACKOFF);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Message.prototype.requeue = function(delay, backoff) {
  if (delay == null) {
    delay = this.requeueDelay;
  }
  if (backoff == null) {
    backoff = true;
  }
  this.respond(Message.REQUEUE, wire.<span class="apidocCodeKeywordSpan">requeue</span>(this.id, delay));
  if (backoff) {
    return this.emit(Message.BACKOFF);
  }
};

Message.prototype.touch = function() {
  this.touchCount += 1;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.respond" id="apidoc.element.nsqjs.message.prototype.respond">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>respond
        <span class="apidocSignatureSpan">(responseType, wireData)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">respond = function (responseType, wireData) {
  if (this.hasResponded) {
    return;
  }
  return process.nextTick((function(_this) {
    return function() {
      if (responseType !== Message.TOUCH) {
        _this.hasResponded = true;
        clearTimeout(_this.trackTimeoutId);
        _this.trackTimeoutId = null;
      } else {
        _this.lastTouched = Date.now();
      }
      return _this.emit(Message.RESPOND, responseType, wireData);
    };
  })(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return delta;
  } else {
    return null;
  }
};

Message.prototype.finish = function() {
  return this.<span class="apidocCodeKeywordSpan">respond</span>(Message.FINISH, wire.finish(this.id));
};

Message.prototype.requeue = function(delay, backoff) {
  if (delay == null) {
    delay = this.requeueDelay;
  }
  if (backoff == null) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.timeUntilTimeout" id="apidoc.element.nsqjs.message.prototype.timeUntilTimeout">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>timeUntilTimeout
        <span class="apidocSignatureSpan">(hard)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeUntilTimeout = function (hard) {
  var delta;
  if (hard == null) {
    hard = false;
  }
  if (this.hasResponded) {
    return null;
  }
  delta = hard ? this.receivedOn + this.maxMsgTimeout - Date.now() : this.lastTouched + this.msgTimeout - Date.now();
  if (delta &#x3e; 0) {
    return delta;
  } else {
    return null;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
console.log(&#x27;Received message [%s]&#x27;, msg.id);

function touch() {
  if (!msg.hasResponded) {
    console.log(&#x27;Touch [%s]&#x27;, msg.id);
    msg.touch();
    // Touch the message again a second before the next timeout.
    setTimeout(touch, msg.<span class="apidocCodeKeywordSpan">timeUntilTimeout</span>() - 1000);
  }
}

function finish() {
  console.log(&#x27;Finished message [%s]: %s&#x27;, msg.id, msg.body.toString());
  msg.finish();
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.message.prototype.touch" id="apidoc.element.nsqjs.message.prototype.touch">
        function <span class="apidocSignatureSpan">nsqjs.message.prototype.</span>touch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">touch = function () {
  this.touchCount += 1;
  this.lastTouched = Date.now();
  return this.respond(Message.TOUCH, wire.touch(this.id));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

reader.on(&#x27;message&#x27;, function (msg) {
console.log(&#x27;Received message [%s]&#x27;, msg.id);

function touch() {
  if (!msg.hasResponded) {
    console.log(&#x27;Touch [%s]&#x27;, msg.id);
    msg.<span class="apidocCodeKeywordSpan">touch</span>();
    // Touch the message again a second before the next timeout.
    setTimeout(touch, msg.timeUntilTimeout() - 1000);
  }
}

function finish() {
  console.log(&#x27;Finished message [%s]: %s&#x27;, msg.id, msg.body.toString());
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.readerrdy" id="apidoc.module.nsqjs.readerrdy">module nsqjs.readerrdy</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.readerrdy.ConnectionRdy" id="apidoc.element.nsqjs.readerrdy.ConnectionRdy">
        function <span class="apidocSignatureSpan">nsqjs.readerrdy.</span>ConnectionRdy
        <span class="apidocSignatureSpan">(conn1)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ConnectionRdy(conn1) {
  var connId, readerId;
  this.conn = conn1;
  readerId = this.conn.topic + &#x22;/&#x22; + this.conn.channel;
  connId = &#x22;&#x22; + (this.conn.id().replace(&#x27;:&#x27;, &#x27;/&#x27;));
  this.debug = Debug(&#x22;nsqjs:reader:&#x22; + readerId + &#x22;:rdy:conn:&#x22; + connId);
  this.maxConnRdy = 0;
  this.inFlight = 0;
  this.lastRdySent = 0;
  this.availableRdy = 0;
  this.statemachine = new ConnectionRdyState(this);
  this.conn.on(NSQDConnection.ERROR, (function(_this) {
    return function(err) {
      return _this.log(err);
    };
  })(this));
  this.conn.on(NSQDConnection.MESSAGE, (function(_this) {
    return function() {
      if (_this.idleId != null) {
        clearTimeout(_this.idleId);
      }
      _this.idleId = null;
      _this.inFlight += 1;
      return _this.availableRdy -= 1;
    };
  })(this));
  this.conn.on(NSQDConnection.FINISHED, (function(_this) {
    return function() {
      return _this.inFlight -= 1;
    };
  })(this));
  this.conn.on(NSQDConnection.REQUEUED, (function(_this) {
    return function() {
      return _this.inFlight -= 1;
    };
  })(this));
  this.conn.on(NSQDConnection.READY, (function(_this) {
    return function() {
      return _this.start();
    };
  })(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.readerrdy.ReaderRdy" id="apidoc.element.nsqjs.readerrdy.ReaderRdy">
        function <span class="apidocSignatureSpan">nsqjs.readerrdy.</span>ReaderRdy
        <span class="apidocSignatureSpan">(maxInFlight, maxBackoffDuration, readerId1, lowRdyTimeout)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ReaderRdy(maxInFlight, maxBackoffDuration, readerId1, lowRdyTimeout) {
  this.maxInFlight = maxInFlight;
  this.maxBackoffDuration = maxBackoffDuration;
  this.readerId = readerId1;
  this.lowRdyTimeout = lowRdyTimeout != null ? lowRdyTimeout : 1.5;
  this.debug = Debug(&#x22;nsqjs:reader:&#x22; + this.readerId + &#x22;:rdy&#x22;);
  ReaderRdy.__super__.constructor.call(this, {
    autostart: true,
    initial_state: &#x27;ZERO&#x27;,
    sync_goto: true
  });
  this.id = ReaderRdy.getId();
  this.backoffTimer = new BackoffTimer(0, this.maxBackoffDuration);
  this.backoffId = null;
  this.balanceId = null;
  this.connections = [];
  this.roundRobinConnections = new RoundRobinList([]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.roundrobinlist" id="apidoc.module.nsqjs.roundrobinlist">module nsqjs.roundrobinlist</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist.roundrobinlist" id="apidoc.element.nsqjs.roundrobinlist.roundrobinlist">
        function <span class="apidocSignatureSpan">nsqjs.</span>roundrobinlist
        <span class="apidocSignatureSpan">(lst)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function RoundRobinList(lst) {
  this.lst = lst.slice(0);
  this.index = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.roundrobinlist.prototype" id="apidoc.module.nsqjs.roundrobinlist.prototype">module nsqjs.roundrobinlist.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist.prototype.add" id="apidoc.element.nsqjs.roundrobinlist.prototype.add">
        function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>add
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (item) {
  return this.lst.push(item);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return _this.raise(&#x27;backoff&#x27;);
  };
})(this));
return connectionRdy.on(ConnectionRdy.READY, (function(_this) {
  return function() {
    var ref;
    _this.connections.push(connectionRdy);
    _this.roundRobinConnections.<span class="apidocCodeKeywordSpan">add</span>(connectionRdy);
    _this.balance();
    if (_this.current_state_name === &#x27;ZERO&#x27;) {
      return _this.goto(&#x27;MAX&#x27;);
    } else if ((ref = _this.current_state_name) === &#x27;TRY_ONE&#x27; || ref === &#x27;MAX&#x27;) {
      return connectionRdy.bump();
    }
  };
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist.prototype.length" id="apidoc.element.nsqjs.roundrobinlist.prototype.length">
        function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>length
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">length = function () {
  return this.lst.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist.prototype.next" id="apidoc.element.nsqjs.roundrobinlist.prototype.next">
        function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>next
        <span class="apidocSignatureSpan">(count)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">next = function (count) {
  var index;
  if (count == null) {
    count = 1;
  }
  index = this.index;
  this.index = (this.index + count) % this.lst.length;
  return this.lst.slice(index, index + count);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

Reader.prototype.queryLookupd = function() {
  var endpoint;
  if (this.isPaused()) {
    return;
  }
  endpoint = this.roundrobinLookupd.<span class="apidocCodeKeywordSpan">next</span>();
  return lookup(endpoint, this.topic, (function(_this) {
    return function(err, nodes) {
      var i, len, n, results;
      if (!err) {
        results = [];
        for (i = 0, len = nodes.length; i &#x3c; len; i++) {
          n = nodes[i];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.roundrobinlist.prototype.remove" id="apidoc.element.nsqjs.roundrobinlist.prototype.remove">
        function <span class="apidocSignatureSpan">nsqjs.roundrobinlist.prototype.</span>remove
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remove = function (item) {
  var itemIndex;
  itemIndex = this.lst.indexOf(item);
  if (itemIndex === -1) {
    return;
  }
  if (this.index &#x3e; itemIndex) {
    this.index -= 1;
  }
  return this.lst.splice(itemIndex, 1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
    };
  })(this));
};

ReaderRdy.prototype.removeConnection = function(conn) {
  this.connections.splice(this.connections.indexOf(conn), 1);
  this.roundRobinConnections.<span class="apidocCodeKeywordSpan">remove</span>(conn);
  if (this.connections.length === 0) {
    return this.goto(&#x27;ZERO&#x27;);
  }
};

ReaderRdy.prototype.bump = function() {
  var conn, j, len, ref, results;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.wire" id="apidoc.module.nsqjs.wire">module nsqjs.wire</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.wire.auth" id="apidoc.element.nsqjs.wire.auth">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>auth
        <span class="apidocSignatureSpan">(token)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">auth = function (token) {
  return command(&#x27;AUTH&#x27;, token);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
},
AUTH: {
  Enter: function() {
    if (!this.conn.config.authSecret) {
      return this.goto(this.afterIdentify());
    }
    this.conn.write(wire.<span class="apidocCodeKeywordSpan">auth</span>(this.conn.config.authSecret));
    return this.goto(&#x27;AUTH_RESPONSE&#x27;);
  }
},
AUTH_RESPONSE: {
  response: function(data) {
    this.conn.auth = JSON.parse(data);
    return this.goto(this.afterIdentify());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.finish" id="apidoc.element.nsqjs.wire.finish">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>finish
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">finish = function (id) {
  if (!(Buffer.byteLength(id) &#x3c;= 16)) {
    throw new Error(&#x22;FINISH invalid id (&#x22; + id + &#x22;)&#x22;);
  }
  return command(&#x27;FIN&#x27;, null, id);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  lookupdHTTPAddresses: &#x27;127.0.0.1:4161&#x27;
});

reader.connect();

reader.on(&#x27;message&#x27;, function (msg) {
  console.log(&#x27;Received message [%s]: %s&#x27;, msg.id, msg.body.toString());
  msg.<span class="apidocCodeKeywordSpan">finish</span>();
});
```

#### CoffeeScript
```coffee-script
nsq = require &#x27;nsqjs&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.identify" id="apidoc.element.nsqjs.wire.identify">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>identify
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">identify = function (data) {
  var unexpectedKeys, validIdentifyKeys;
  validIdentifyKeys = [&#x27;client_id&#x27;, &#x27;deflate&#x27;, &#x27;deflate_level&#x27;, &#x27;feature_negotiation&#x27;, &#x27;heartbeat_interval&#x27;, &#x27;long_id&#x27;, &#x27;msg_timeout
&#x27;, &#x27;output_buffer_size&#x27;, &#x27;output_buffer_timeout&#x27;, &#x27;sample_rate&#x27;, &#x27;short_id&#x27;, &#x27;snappy&#x27;, &#x27;tls_v1&#x27;, &#x27;user_agent&#x27;];
  unexpectedKeys = _.filter(_.keys(data), function(k) {
    return indexOf.call(validIdentifyKeys, k) &#x3c; 0;
  });
  if (unexpectedKeys.length) {
    throw new Error(&#x22;Unexpected IDENTIFY keys: &#x22; + unexpectedKeys);
  }
  return command(&#x27;IDENTIFY&#x27;, JSON_stringify(data));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    this.conn.write(wire.MAGIC_V2);
    return this.goto(&#x27;IDENTIFY&#x27;);
  }
},
IDENTIFY: {
  Enter: function() {
    var identify;
    identify = this.conn.<span class="apidocCodeKeywordSpan">identify</span>();
    this.conn.debug(identify);
    this.conn.write(wire.identify(identify));
    return this.goto(&#x27;IDENTIFY_RESPONSE&#x27;);
  }
},
IDENTIFY_RESPONSE: {
  response: function(data) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.mpub" id="apidoc.element.nsqjs.wire.mpub">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>mpub
        <span class="apidocSignatureSpan">(topic, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mpub = function (topic, data) {
  var messages, numMessagesBuffer;
  if (!_.isArray(data)) {
    throw new Error(&#x22;MPUB requires an array of message&#x22;);
  }
  messages = _.map(data, function(message) {
    var buffer;
    buffer = new Buffer(4 + byteLength(message));
    buffer.writeInt32BE(byteLength(message), 0);
    if (_.isString(message)) {
      buffer.write(message, 4);
    } else {
      message.copy(buffer, 4, 0, buffer.length);
    }
    return buffer;
  });
  numMessagesBuffer = Buffer(4);
  numMessagesBuffer.writeInt32BE(messages.length, 0);
  messages.unshift(numMessagesBuffer);
  return command(&#x27;MPUB&#x27;, Buffer.concat(messages), topic);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this.conn.messageCallbacks.push(callback);
  if (!_.isArray(msgs)) {
    throw new Error(&#x27;Expect an array of messages to produceMessages&#x27;);
  }
  if (msgs.length === 1) {
    return this.conn.write(wire.pub(topic, msgs[0]));
  } else {
    return this.conn.write(wire.<span class="apidocCodeKeywordSpan">mpub</span>(topic, msgs));
  }
},
response: function(data) {
  var cb;
  switch (data.toString()) {
    case &#x27;OK&#x27;:
      cb = this.conn.messageCallbacks.shift();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.nop" id="apidoc.element.nsqjs.wire.nop">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>nop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nop = function () {
  return command(&#x27;NOP&#x27;, null);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},
READY_RECV: {
  consumeMessage: function(msg) {
    return this.conn.emit(NSQDConnection.MESSAGE, msg);
  },
  response: function(data) {
    if (data.toString() === &#x27;_heartbeat_&#x27;) {
      return this.conn.write(wire.<span class="apidocCodeKeywordSpan">nop</span>());
    }
  },
  ready: function(rdyCount) {
    if (rdyCount &#x3e; this.conn.maxRdyCount) {
      rdyCount = this.conn.maxRdyCount;
    }
    return this.conn.write(wire.ready(rdyCount));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.pub" id="apidoc.element.nsqjs.wire.pub">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>pub
        <span class="apidocSignatureSpan">(topic, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pub = function (topic, data) {
  return command(&#x27;PUB&#x27;, data, topic);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var callback, msgs, topic;
  topic = data[0], msgs = data[1], callback = data[2];
  this.conn.messageCallbacks.push(callback);
  if (!_.isArray(msgs)) {
    throw new Error(&#x27;Expect an array of messages to produceMessages&#x27;);
  }
  if (msgs.length === 1) {
    return this.conn.write(wire.<span class="apidocCodeKeywordSpan">pub</span>(topic, msgs[0]));
  } else {
    return this.conn.write(wire.mpub(topic, msgs));
  }
},
response: function(data) {
  var cb;
  switch (data.toString()) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.ready" id="apidoc.element.nsqjs.wire.ready">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>ready
        <span class="apidocSignatureSpan">(count)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ready = function (count) {
  if (!_.isNumber(count)) {
    throw new Error(&#x22;RDY count (&#x22; + count + &#x22;) is not a number&#x22;);
  }
  if (!(count &#x3e;= 0)) {
    throw new Error(&#x22;RDY count (&#x22; + count + &#x22;) is not positive&#x22;);
  }
  return command(&#x27;RDY&#x27;, null, count.toString());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      return this.conn.write(wire.nop());
    }
  },
  ready: function(rdyCount) {
    if (rdyCount &#x3e; this.conn.maxRdyCount) {
      rdyCount = this.conn.maxRdyCount;
    }
    return this.conn.write(wire.<span class="apidocCodeKeywordSpan">ready</span>(rdyCount));
  },
  close: function() {
    return this.goto(&#x27;CLOSED&#x27;);
  }
},
READY_SEND: {
  Enter: function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.requeue" id="apidoc.element.nsqjs.wire.requeue">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>requeue
        <span class="apidocSignatureSpan">(id, timeMs)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">requeue = function (id, timeMs) {
  var parameters;
  if (timeMs == null) {
    timeMs = 0;
  }
  if (!(Buffer.byteLength(id) &#x3c;= 16)) {
    throw new Error(&#x22;REQUEUE invalid id (&#x22; + id + &#x22;)&#x22;);
  }
  if (!_.isNumber(timeMs)) {
    throw new Error(&#x22;REQUEUE delay time is invalid (&#x22; + timeMs + &#x22;)&#x22;);
  }
  parameters = [&#x27;REQ&#x27;, null, id, timeMs];
  return command.apply(null, parameters);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Message.prototype.requeue = function(delay, backoff) {
  if (delay == null) {
    delay = this.requeueDelay;
  }
  if (backoff == null) {
    backoff = true;
  }
  this.respond(Message.REQUEUE, wire.<span class="apidocCodeKeywordSpan">requeue</span>(this.id, delay));
  if (backoff) {
    return this.emit(Message.BACKOFF);
  }
};

Message.prototype.touch = function() {
  this.touchCount += 1;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.subscribe" id="apidoc.element.nsqjs.wire.subscribe">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>subscribe
        <span class="apidocSignatureSpan">(topic, channel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (topic, channel) {
  if (!validTopicName(topic)) {
    throw new Error(&#x22;Invalid topic: &#x22; + topic);
  }
  if (!validChannelName(channel)) {
    throw new Error(&#x22;Invalid channel: &#x22; + channel);
  }
  return command(&#x27;SUB&#x27;, null, topic, channel);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  response: function(data) {
    this.conn.auth = JSON.parse(data);
    return this.goto(this.afterIdentify());
  }
},
SUBSCRIBE: {
  Enter: function() {
    this.conn.write(wire.<span class="apidocCodeKeywordSpan">subscribe</span>(this.conn.topic, this.conn.channel));
    return this.goto(&#x27;SUBSCRIBE_RESPONSE&#x27;);
  }
},
SUBSCRIBE_RESPONSE: {
  response: function(data) {
    if (data.toString() === &#x27;OK&#x27;) {
      this.goto(&#x27;READY_RECV&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.touch" id="apidoc.element.nsqjs.wire.touch">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>touch
        <span class="apidocSignatureSpan">(id)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">touch = function (id) {
  return command(&#x27;TOUCH&#x27;, null, id);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

reader.on(&#x27;message&#x27;, function (msg) {
console.log(&#x27;Received message [%s]&#x27;, msg.id);

function touch() {
  if (!msg.hasResponded) {
    console.log(&#x27;Touch [%s]&#x27;, msg.id);
    msg.<span class="apidocCodeKeywordSpan">touch</span>();
    // Touch the message again a second before the next timeout.
    setTimeout(touch, msg.timeUntilTimeout() - 1000);
  }
}

function finish() {
  console.log(&#x27;Finished message [%s]: %s&#x27;, msg.id, msg.body.toString());
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.wire.unpackMessage" id="apidoc.element.nsqjs.wire.unpackMessage">
        function <span class="apidocSignatureSpan">nsqjs.wire.</span>unpackMessage
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unpackMessage = function (data) {
  var attempts, body, id, timestamp;
  timestamp = (new Int64(data, 0)).toOctetString();
  timestamp = new BigNumber(timestamp, 16);
  attempts = data.readInt16BE(8);
  id = data.slice(10, 26).toString();
  body = data.slice(26);
  return [id, timestamp, attempts, body];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
NSQDConnection.prototype.clearIdentifyTimeout = function() {
  clearTimeout(this.identifyTimeoutId);
  return this.identifyTimeoutId = null;
};

NSQDConnection.prototype.createMessage = function(msgPayload) {
  var msg, msgComponents;
  msgComponents = wire.<span class="apidocCodeKeywordSpan">unpackMessage</span>(msgPayload);
  msg = (function(func, args, ctor) {
    ctor.prototype = func.prototype;
    var child = new ctor, result = func.apply(child, args);
    return Object(result) === result ? result : child;
  })(Message, slice.call(msgComponents).concat([this.config.requeueDelay], [this.msgTimeout], [this.maxMsgTimeout]), function(){});
  this.debug(&#x22;Received message [&#x22; + msg.id + &#x22;] [attempts: &#x22; + msg.attempts + &#x22;]&#x22;);
  msg.on(Message.RESPOND, (function(_this) {
...</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.writer" id="apidoc.module.nsqjs.writer">module nsqjs.writer</a></h1>




    <h2>
        <a href="#apidoc.element.nsqjs.writer.writer" id="apidoc.element.nsqjs.writer.writer">
        function <span class="apidocSignatureSpan">nsqjs.</span>writer
        <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Writer(nsqdHost, nsqdPort, options) {
  this.nsqdHost = nsqdHost;
  this.nsqdPort = nsqdPort;
  Writer.__super__.constructor.apply(this, arguments);
  this.setMaxListeners(10000);
  this.debug = Debug(&#x22;nsqjs:writer:&#x22; + this.nsqdHost + &#x22;/&#x22; + this.nsqdPort);
  this.config = new ConnectionConfig(options);
  this.config.validate();
  this.ready = false;
  this.debug(&#x27;Configuration&#x27;);
  this.debug(this.config);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.EventEmitter" id="apidoc.element.nsqjs.writer.EventEmitter">
        function <span class="apidocSignatureSpan">nsqjs.writer.</span>EventEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.init" id="apidoc.element.nsqjs.writer.init">
        function <span class="apidocSignatureSpan">nsqjs.writer.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  this.domain = null;
  if (EventEmitter.usingDomains) {
    // if there is an active domain, then attach to it.
    domain = domain || require(&#x27;domain&#x27;);
    if (domain.active &#x26;&#x26; !(this instanceof domain.Domain)) {
      this.domain = domain.active;
    }
  }

  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {
    this._events = new EventHandlers();
    this._eventsCount = 0;
  }

  this._maxListeners = this._maxListeners || undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.listenerCount" id="apidoc.element.nsqjs.writer.listenerCount">
        function <span class="apidocSignatureSpan">nsqjs.writer.</span>listenerCount
        <span class="apidocSignatureSpan">(emitter, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listenerCount = function (emitter, type) {
  if (typeof emitter.listenerCount === &#x27;function&#x27;) {
    return emitter.listenerCount(type);
  } else {
    return listenerCount.call(emitter, type);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>












</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.nsqjs.writer.prototype" id="apidoc.module.nsqjs.writer.prototype">module nsqjs.writer.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.nsqjs.writer.prototype.close" id="apidoc.element.nsqjs.writer.prototype.close">
        function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  return this.conn.destroy();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  w.publish(&#x27;sample_topic&#x27;, [
    &#x27;Uh, excuse me. Mark it zero. Next frame.&#x27;,
    &#x27;Smokey, this is not \&#x27;Nam. This is bowling. There are rules.&#x27;
  ]);
  w.publish(&#x27;sample_topic&#x27;, &#x27;Wu?&#x27;, function (err) {
    if (err) { return console.error(err.message); }
    console.log(&#x27;Message sent successfully&#x27;);
    w.<span class="apidocCodeKeywordSpan">close</span>();
  });
});

w.on(&#x27;closed&#x27;, function () {
  console.log(&#x27;Writer closed&#x27;);
});
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.prototype.connect" id="apidoc.element.nsqjs.writer.prototype.connect">
        function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>connect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function () {
  this.conn = new WriterNSQDConnection(this.nsqdHost, this.nsqdPort, this.config);
  this.debug(&#x27;connect&#x27;);
  this.conn.connect();
  this.conn.on(WriterNSQDConnection.READY, (function(_this) {
    return function() {
      _this.debug(&#x27;ready&#x27;);
      _this.ready = true;
      return _this.emit(Writer.READY);
    };
  })(this));
  this.conn.on(WriterNSQDConnection.CLOSED, (function(_this) {
    return function() {
      _this.debug(&#x27;closed&#x27;);
      _this.ready = false;
      return _this.emit(Writer.CLOSED);
    };
  })(this));
  this.conn.on(WriterNSQDConnection.ERROR, (function(_this) {
    return function(err) {
      _this.debug(&#x27;error&#x27;, err);
      _this.ready = false;
      return _this.emit(Writer.ERROR, err);
    };
  })(this));
  return this.conn.on(WriterNSQDConnection.CONNECTION_ERROR, (function(_this) {
    return function(err) {
      _this.debug(&#x27;error&#x27;, err);
      _this.ready = false;
      return _this.emit(Writer.ERROR, err);
    };
  })(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```js
var nsq = require(&#x27;nsqjs&#x27;);

var reader = new nsq.Reader(&#x27;sample_topic&#x27;, &#x27;test_channel&#x27;, {
  lookupdHTTPAddresses: &#x27;127.0.0.1:4161&#x27;
});

reader.<span class="apidocCodeKeywordSpan">connect</span>();

reader.on(&#x27;message&#x27;, function (msg) {
  console.log(&#x27;Received message [%s]: %s&#x27;, msg.id, msg.body.toString());
  msg.finish();
});
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.prototype.constructor" id="apidoc.element.nsqjs.writer.prototype.constructor">
        function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>constructor
        <span class="apidocSignatureSpan">(nsqdHost, nsqdPort, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Writer(nsqdHost, nsqdPort, options) {
  this.nsqdHost = nsqdHost;
  this.nsqdPort = nsqdPort;
  Writer.__super__.constructor.apply(this, arguments);
  this.setMaxListeners(10000);
  this.debug = Debug(&#x22;nsqjs:writer:&#x22; + this.nsqdHost + &#x22;/&#x22; + this.nsqdPort);
  this.config = new ConnectionConfig(options);
  this.config.validate();
  this.ready = false;
  this.debug(&#x27;Configuration&#x27;);
  this.debug(this.config);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.nsqjs.writer.prototype.publish" id="apidoc.element.nsqjs.writer.prototype.publish">
        function <span class="apidocSignatureSpan">nsqjs.writer.prototype.</span>publish
        <span class="apidocSignatureSpan">(topic, msgs, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publish = function (topic, msgs, callback) {
  var connState, err, failed, msg, ready, ref, ref1, remove;
  connState = (ref = this.conn) != null ? (ref1 = ref.statemachine) != null ? ref1.current_state_name : void 0 : void 0;
  if (!this.conn || (connState === &#x27;CLOSED&#x27; || connState === &#x27;ERROR&#x27;)) {
    err = new Error(&#x27;No active Writer connection to send messages&#x27;);
  }
  if (!msgs || _.isEmpty(msgs)) {
    err = new Error(&#x27;Attempting to publish an empty message&#x27;);
  }
  if (err) {
    if (callback) {
      return callback(err);
    }
    throw err;
  }
  if (!this.ready) {
    ready = (function(_this) {
      return function() {
        remove();
        return _this.publish(topic, msgs, callback);
      };
    })(this);
    failed = function(err) {
      err || (err = new Error(&#x27;Connection closed!&#x27;));
      remove();
      return callback(err);
    };
    remove = (function(_this) {
      return function() {
        _this.removeListener(Writer.READY, ready);
        _this.removeListener(Writer.ERROR, failed);
        return _this.removeListener(Writer.CLOSED, failed);
      };
    })(this);
    this.on(Writer.READY, ready);
    this.on(Writer.ERROR, failed);
    this.on(Writer.CLOSED, failed);
    return;
  }
  if (!_.isArray(msgs)) {
    msgs = [msgs];
  }
  msgs = (function() {
    var i, len, results;
    results = [];
    for (i = 0, len = msgs.length; i &#x3c; len; i++) {
      msg = msgs[i];
      if (_.isString(msg) || Buffer.isBuffer(msg)) {
        results.push(msg);
      } else {
        results.push(JSON.stringify(msg));
      }
    }
    return results;
  })();
  return this.conn.produceMessages(topic, msgs, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var nsq = require(&#x27;nsqjs&#x27;);

var w = new nsq.Writer(&#x27;127.0.0.1&#x27;, 4150);

w.connect();

w.on(&#x27;ready&#x27;, function () {
w.<span class="apidocCodeKeywordSpan">publish</span>(&#x27;sample_topic&#x27;, &#x27;it really tied the room together&#x27;);
w.publish(&#x27;sample_topic&#x27;, [
  &#x27;Uh, excuse me. Mark it zero. Next frame.&#x27;,
  &#x27;Smokey, this is not \&#x27;Nam. This is bowling. There are rules.&#x27;
]);
w.publish(&#x27;sample_topic&#x27;, &#x27;Wu?&#x27;, function (err) {
  if (err) { return console.error(err.message); }
  console.log(&#x27;Message sent successfully&#x27;);
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
